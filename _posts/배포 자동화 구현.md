---
title: "ğŸ’» Github Actionìœ¼ë¡œ ë°ìŠ¤í¬íƒ‘ ì•±ì„ ìë™ìœ¼ë¡œ ë°°í¬í•˜ëŠ” ë°©ë²•"
date: "2023-11-30"
tag: 'Deep Dive'
---


#### Motivation
pyqt6ë¥¼ í™œìš©í•˜ì—¬ ê°œë°œí•œ python ë°ìŠ¤í¬íƒ‘ ì•±ì„ ë°°í¬í•˜ê¸°ê¹Œì§€ ì„±ê³µí–ˆë‹¤. 
pyinstallerë¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ë¥¼ ì´ìš©í•´ í•˜ë‚˜ì˜ ì‹¤í–‰ íŒŒì¼ë¡œ ì••ì¶•í•˜ì—¬ ë°°í¬í–ˆì§€ë§Œ, í´ë¼ì´ì–¸íŠ¸ ì¸¡ì—ì„œ ì•Œìˆ˜ì—†ëŠ” ì˜¤ë¥˜ë“¤ì´ ë°œìƒí–ˆê³  ì´ë¥¼ í•´ê²°í•˜ê¸°ìœ„í•œ ë°©ë²•ì„ ëª¨ìƒ‰í–ˆë‹¤.

ìš°ì„ , pyinstallerë¥¼ ì‚¬ìš©í•˜ì—¬ ì•±ì„ íŒ¨í‚¤ì§•í•˜ëŠ” ê³¼ì •ì€ ë‚˜ë¦„ì˜ ë¶ˆí¸í•¨ì´ ë™ë°˜í•œë‹¤.
windowì˜ ê²½ìš° exe íŒŒì¼, macOsì˜ ê²½ìš° app ë²ˆë“¤ë¡œ ì´ë£¨ì–´ì§„ë‹¤. windowsìš© ì•±ì„ ë¹Œë“œí•˜ë ¤ë©´ windowsì—ì„œ pyintstallerë¥¼ ì‹¤í–‰í•´ì•¼í•˜ë©°, macìš© ì•±ì„ ë¹Œë“œí•˜ë ¤ë©´ macì—ì„œ pyinstallerë¥¼ ì‹¤í–‰í•´ì•¼í•œë‹¤. 

ì¦‰, ê° osì˜ ì‹¤í–‰ í™˜ê²½ì´ ì•„ë‹ˆë©´ ë¹Œë“œí•  ìˆ˜ ì—†ë‹¤. (í…ŒìŠ¤íŠ¸ë„ ë§ˆì°¬ê°€ì§€ë‹¤)
ë‚˜ëŠ” mac m2ë¥¼ ë©”ì¸ ì»´í“¨í„°ë¡œ ì“°ê³ ìˆê¸°ì— ìœˆë„ìš° íŒ¨í‚¤ì§•ì´ ì• ë§¤í–ˆê³  ê²°êµ­, ì˜ˆì „ì— ì“°ë˜ gram 14ì¸ì¹˜ì§œë¦¬ë¥¼ ë“¤ê³ ë‹¤ë‹ˆë©° ì•±ì„ ë¹Œë“œí•˜ê³ ë‹¤ë…”ë‹¤.

í…ŒìŠ¤íŠ¸ì˜ í•œê³„ë¥¼ ë„˜ì–´ macì˜ ë‹¤ì–‘í•œ í™˜ê²½(Intel ê¸°ë°˜ ë“±)ì—ì„œ ë°œìƒí•˜ëŠ” ì˜¤ë¥˜ë¥¼ ì¡ì§€ ëª»í•˜ê²Œ ë˜ì, CI/CD(ì§€ì†ì  í†µí•©/ë°°í¬) ë°©ë²•ì„ ë„ì…í•´ì•¼ê² ë‹¤ê³  ìƒê°í–ˆë‹¤.

#### GitHub Actionì„ ì„ íƒ
í´ë¼ìš°ë“œ êµ¬ì¶•ì—ëŠ” ì—¬ëŸ¬ ì˜µì…˜ì´ ìˆì§€ë§Œ, githubë¥¼ ì§€ì†ì ìœ¼ë¡œ í™œìš©í•˜ê³  ë°°í¬í•˜ê³ ìˆê¸°ì— GitHub Actionì„ ì„ íƒí•˜ê¸°ë¡œ ê²°ì •í–ˆë‹¤. 
GitHub Actionì€ CI/CD ë„êµ¬ë¡œ public ë ˆíŒŒì§€í† ë¦¬ë¼ë©´ ë¬´ë£Œë¡œ ì‚¬ìš©ê°€ëŠ¥í•˜ë‹¤. Linux, Windows, MacOsë¥¼ ì‹¤í–‰í•˜ëŠ” í´ë¼ìš°ë“œ ì‹œìŠ¤í…œì—ì„œ ì‹¤í–‰ë  ì›Œí¬í”Œë¡œë¥¼ ì •ì˜í• ìˆ˜ìˆê³ ,ì´ëŠ” ë‹¤ì–‘í•œ í”Œë ›í¼ì—ì„œ êµ¬ì¶•í•´ì•¼í•˜ëŠ” ì‚¬ë¡€ì— ì í•©í•˜ë‹¤. (ì´ê²Œ ë‹¹ìµœ ë¬´ìŠ¨ë§ì´ëƒ í•˜ë©´, github ì—ì„œ ê·¸ëƒ¥ ê°ê°ì˜ os ì»´í“¨í„°ë¥¼ ë¹Œë ¤ì£¼ì–´ì„œ ì´ê±¸ ë°”íƒ•ìœ¼ë¡œ ì•±ì„ ë¹Œë“œí• ìˆ˜ìˆë‹¤ëŠ” ê²ƒì´ë‹¤.)


---

#### GitHub Action ì‹œì‘í•˜ê¸°

GItHub Actionsë¥¼ ì‹œì‘í•˜ë ¤ë©´ ì•± ì €ì¥ì†Œì— ë‹¤ìŒê³¼ ê°™ì€ í´ë”ë¥¼ ë§Œë“ ë‹¤
```linux
mkdir -p .github/workflows/
```

ê·¸ë¦¬ê³  build.yml ì— ì‘ì—…ì„ ì •ì˜í•˜ëŠ” íŒŒì¼ì„ ì¶”ê°€í•œë‹¤. 
github action ì´ build.ymlì„ ì½ì–´ì˜¤ë©´ì„œ ë¹Œë“œí•´ì¤€ë‹¤.

ì‚¬ìš©ìê°€ ì›í•˜ëŠ” ìˆœì„œëŒ€ë¡œ ë¹Œë“œ ëª…ë ¹ì–´ë¥¼ ì•Œë§ê²Œ ì„¤ì •í•´ì£¼ë©´ ë˜ëŠ”ë°, ë‚˜ì˜ ê²½ìš° pyinstallerë¡œ ê°ê°ì˜ os ì—ì„œ íŒŒì¼ì„ íŒ¨í‚¤ì§•í•´ì£¼ë„ë¡ ì„¤ì •í•´ì£¼ì—ˆë‹¤.

action ì„ ìœ„í•´ì„œ ì„¤ì •í•´ë³´ìë©´,

1. push :  push ì´ë²¤íŠ¸ì—ì„œ ë‹¤ìŒ ì‘ì—…ì´ ì‹¤í–‰ë˜ë„ë¡ ì •ì˜í•œë‹¤.
   ì»¤ë°‹ì— 'v'ë¥¼ ì ‘ë‘ì‚¬ë¡œ ì‚¬ìš©í•˜ì—¬ íƒœê·¸ê°€ ì§€ì •ëœ ê²½ìš°ì—ë§Œ í•´ë‹¹ë˜ê²Œ í•´ì£¼ì—ˆë‹¤. 
```yml
name: Build

on:
  push:
    tags:
      - 'v*' # Push events to matching v*, i.e. v1.0, v20.15.10
```

2. createrrelease : githubì—ì„œ ìƒˆ releaseë¥¼ ìƒì„±í•˜ëŠ” ì‘ì—…ì„ ë‹´ë‹¹í•œë‹¤. 

```yml

jobs:
  createrelease:
    name: Create Release
    runs-on: ubuntu-latest
    steps:
      - name: Create Release
        id: create_release
        uses: actions/create-release@v1
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with:
          tag_name: ${{ github.ref }}
          release_name: Release ${{ github.ref }}
          draft: false
          prerelease: false
      - name: Output Release URL File
        run: echo "${{ steps.create_release.outputs.upload_url }}" > release_url.txt
      - name: Save Release URL File for publish
        uses: actions/upload-artifact@v1
        with:
          name: release_url
          path: release_url.txt
```


3. build : createrelease ì‘ì—…ì´ ì™„ë£Œëœ í›„ì— ì‹¤í–‰ëœë‹¤. strategyíŒŒíŠ¸ì—ì„œ ë‘ê°€ì§€ ë²„ì „ì„ ì •ì˜í• ìˆ˜ì´ì“´ë° MacOsì™€ WIndows ë²„ì „ì´ë‹¤. ì´ ê³¼ì •ë“¤ì€ ì¡°ê¸ˆë” ì„¸ë¶€ì ìœ¼ë¡œ ë³¼ìˆ˜ìˆëŠ”ë°,
	1. ê°ê°ì˜ ì‹œìŠ¤í…œì˜ ë™ì‘ì„ ì •ì˜í•´ì¤€ë‹¤.
	2. actions/checkout@v1 ì €ì¥ì†Œê°€ í´ë¼ìš°ë“œ ì‹œìŠ¤í…œì— ë³µì œëœë‹¤.
	3. ì €ì¥ì†Œì—ì„œ requirements.txt ë¥¼ í†µí•´ ì¢…ì†ì„± ë¬¸ì œë¥¼ í•´ê²°í•´ì¤€ë‹¤.
	4. íŒ¨í‚¤ì§€ëŠ” pyinstallerë¥¼ ì‚¬ìš©í•˜ì—¬ ìƒì„±ëœë‹¤. 
	5. createreleaseì—ì„œ ì‘ì—…í•œ realase urlì´ í‘œí•¨ëœ íŒŒì¼ì„ ë‹¤ìš´ë°›ëŠ”ë‹¤
	6. íŒŒì¼ì—ì„œ release url ì„ ì¶”ì¶œí•´ ë³€ìˆ˜ì— ì €ì¥í•œë‹¤
	7. ê·¸ release url ì— íŒ¨í‚¤ì§• ì•±ë“¤ì„ ì—…ë¡œë“œí•œë‹¤.

```yml
  build:
    name: Build packages
    needs: createrelease
    runs-on: ubuntu-latest
    strategy:
      matrix:
        include:
          - os: macos-latest
            TARGET: macos
            CMD_BUILD: |
              pyinstaller app.spec
              cd dist/ 
              zip -r9 DICOM_Anonymizer.zip DICOM_Anonymizer
              cd ../
            OUT_FILE_NAME: DICOM_Anonymizer.zip
            ASSET_MIME: application/zip
          - os: windows-latest
            TARGET: windows
            CMD_BUILD: pyinstaller app.spec
            OUT_FILE_NAME: DICOM_Anonymizer.exe
            ASSET_MIME: application/x-msdownload

    steps:
      - uses: actions/checkout@v1
      - name: Set up Python
        uses: actions/setup-python@v2
        with:
          python-version: 3.12
      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt
      - name: Build with pyinstaller for ${{ matrix.TARGET }}
        run: ${{ matrix.CMD_BUILD }}
      - name: Download Release URL File
        uses: actions/download-artifact@v1
        with:
          name: release_url
      - name: Get Release File Name & Upload URL
        id: get_release_info
        shell: bash
        run: echo ::set-output name=upload_url::$(<release_url/release_url.txt)
      - name: Upload Release Asset
        id: upload-release-asset
        uses: actions/upload-release-asset@v1
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with:
          upload_url: ${{ steps.get_release_info.outputs.upload_url }}
          asset_path: ./dist/${{ matrix.OUT_FILE_NAME }}
          asset_name: ${{ matrix.OUT_FILE_NAME }}
          asset_content_type: ${{ matrix.ASSET_MIME }}

```




ì´ë ‡ê²Œ ì„¤ì •í•˜ì—¬ ì™„ì„±ëœ build.yml ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.
```yaml
name: Build

on:
  push:
    tags:
      - 'v*' # Push events to matching v*, i.e. v1.0, v20.15.10

jobs:
  createrelease:
    name: Create Release
    runs-on: ubuntu-latest
    steps:
      - name: Create Release
        id: create_release
        uses: actions/create-release@v1
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with:
          tag_name: ${{ github.ref }}
          release_name: Release ${{ github.ref }}
          draft: false
          prerelease: false
      - name: Save Release URL File
        run: echo "${{ steps.create_release.outputs.upload_url }}" > release_url.txt
      - name: Upload Release URL File
        uses: actions/upload-artifact@v1
        with:
          name: release_url
          path: release_url.txt

  build:
    name: Build packages
    needs: createrelease
    runs-on: ubuntu-latest
    strategy:
      matrix:
        include:
          - os: macos-latest
            TARGET: macos
            CMD_BUILD: |
              pyinstaller app.spec
              cd dist/ 
              zip -r9 DICOM_Anonymizer.zip DICOM_Anonymizer
              cd ../
            OUT_FILE_NAME: DICOM_Anonymizer.zip
            ASSET_MIME: application/zip
          - os: windows-latest
            TARGET: windows
            CMD_BUILD: pyinstaller app.spec
            OUT_FILE_NAME: DICOM_Anonymizer.exe
            ASSET_MIME: application/x-msdownload

    steps:
      - uses: actions/checkout@v1
      - name: Set up Python
        uses: actions/setup-python@v2
        with:
          python-version: 3.12
      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt
      - name: Build with pyinstaller for ${{ matrix.TARGET }}
        run: ${{ matrix.CMD_BUILD }}
      - name: Download Release URL File
        uses: actions/download-artifact@v1
        with:
          name: release_url
      - name: Get Release File Name & Upload URL
        id: get_release_info
        shell: bash
        run: echo ::set-output name=upload_url::$(<release_url/release_url.txt)
      - name: Upload Release Asset
        id: upload-release-asset
        uses: actions/upload-release-asset@v1
        env:
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        with:
          upload_url: ${{ steps.get_release_info.outputs.upload_url }}
          asset_path: ./dist/${{ matrix.OUT_FILE_NAME }}
          asset_name: ${{ matrix.OUT_FILE_NAME }}
          asset_content_type: ${{ matrix.ASSET_MIME }}

```

---

#### GitHub Action ì‹¤í–‰í•˜ê¸°

ì•Œìˆ˜ì—†ëŠ” permission ì˜¤ë¥˜ê°€ ë°œìƒí• ìˆ˜ìˆëŠ”ë°, action ì˜ [permission ê´€ë ¨](https://github.com/orgs/community/discussions/60820) í•˜ì—¬  ì„¤ì •ì„ ë§Œì ¸ì¤˜ì•¼í•œë‹¤.


![](https://i.imgur.com/XBxmp7A.png)


ì´ì™€ ê°™ì´ ì“°ê¸° ì½ê¸° ê¶Œí•œì„ ë¶€ì—¬í•´ì•¼ ì œëŒ€ë¡œ ì‹¤í–‰ì´ ëœë‹¤.

 ë˜í•œ, [GITHUB_TOKEN](https://docs.github.com/ko/actions/security-guides/automatic-token-authentication) ì„ ë”°ë¡œ ì„¤ì •í•´ì¤˜ì•¼í•œë‹¤ê³  ìƒê°í–ˆëŠ”ë°, ìë™ìœ¼ë¡œ ìƒì„±ëœë‹¤ê³  í•œë‹¤. (ì´ì™¸ì˜ í† í°ì„ ì¶”ê°€ì ìœ¼ë¡œ í•¸ë“¤ë§í•˜ë ¤ë©´, action ì˜ í† í° ê´€ë ¨í•˜ì—¬ ì„¤ì •ì„ í•´ì¤˜ì•¼í•œë‹¤. )
 
 ì´ì œ ë¹Œë“œ ì›Œí¬í”Œë¡œìš°ë¥¼ ì‹¤í–‰ì‹œì¼œë³´ì. ë‹¤ìŒì˜ ëª…ë ¹ì–´ë¥¼ ì³ë³´ë©´ì„œ í…ŒìŠ¤íŠ¸í• ìˆ˜ìˆë‹¤.
```bash
git commit -a -m "add autostart enable and disable scripts to pypi"
git tag v0.4.5
git push
git push origin --tags
```


ì‹¤ì œ action íƒ­ì— ë“¤ì–´ê°€ë³´ë©´ buildê°€ ì™„ë£Œë˜ì—ˆë‹¤ê³  ì•Œë ¤ì¤€ë‹¤.

![](https://i.imgur.com/s59gB4M.png)


ì„¤ì •í•œëŒ€ë¡œ, releaseì—ê¹Œì§€ ì˜ ì—…ë¡œë“œ ë˜ì—ˆë‹¤.

![](https://i.imgur.com/dUnwZ59.png)


ë‚˜ì˜ í™˜ê²½ì¸ m2 ì—ì„œ ì‹¤í–‰í•´ë³´ë‹ˆ, ë§ì§€ì•ŠëŠ” exec í˜•ì‹ì´ë¼ê³  ì—ëŸ¬ê°€ ë‚˜ëŠ”ê²ƒì„ í™•ì¸í–ˆë‹¤.
mac m2 ê¸°ì¤€ìœ¼ë¡œ ë‚˜ì˜ arch ëŠ” arm64ì´ê³ , m1ê³¼ m2 ì— íƒ‘ì¬ë˜ëŠ” apple siliconì„ ì§€ì›í•˜ëŠ” ëª¨ë¸ì´ ìµœê·¼ 2023ë…„ 10ì›”ì— ì •ì‹ ì¶œì‹œë˜ì—ˆë‹¤ê³  í•œë‹¤. 
ì°¸ê³  : ([Introducing the new, Apple silicon powered M1 macOS larger runner for GitHub Actions - The GitHub Blog](https://github.blog/2023-10-02-introducing-the-new-apple-silicon-powered-m1-macos-larger-runner-for-github-actions/))


ê·¸ëŸ¬ë¯€ë¡œ m1, m2 ì— ì§€ì›ê°€ëŠ¥í•œ í˜•íƒœë¡œ ëª¨ë‘ ìˆ˜ì •í•´ì¤˜ì•¼í• ê²ƒê°™ë‹¤.

****



#### Conclusion
ê²°ë¡ ì ìœ¼ë¡œ í†µí•©ëœ ê°œë°œ í™˜ê²½ê³¼ ìœ ì§€ë³´ìˆ˜ë¥¼ ìœ„í•´ì„œëŠ” CI/CDë¥¼ ë„ì…í•˜ëŠ”ê²ƒì´ ë„ì›€ì´ ëœë‹¤.
ë‹¤ì–‘í•œ osì— ë§ì¶”ì–´ ë¹Œë“œë¥¼ í• ìˆ˜ìˆê³ , ì‹¤ì œ ë‚˜ì˜ ë¡œì»¬ ë””ë ‰í† ë¦¬ë¥¼ ê±°ì¹˜ì§€ ì•Šê³ ë„ ë¹Œë“œê°€ ê°€ëŠ¥í•˜ë‹¤ëŠ” ì ì´ í¸ë¦¬í•˜ë‹¤. ë˜í•œ, í†µí•©ë˜ê³  ì•ˆì •ëœ í™˜ê²½ì—ì„œ ë¹Œë“œë¥¼ ì§„í–‰í•˜ê¸°ì— ì˜¤ë¥˜ê°€ ë‚  í™•ë¥ ë„ ì ì–´ì§„ë‹¤ëŠ” ì´ì ë„ ìˆëŠ”ê²ƒê°™ë‹¤.
ì¶”í›„ í…ŒìŠ¤íŠ¸ë¥¼ ê±°ì¹˜ë©°, ë‹¤ì–‘í•œ ë²„ì „ì„ ì¶”ê°€í•´ì•¼í• ê²ƒê°™ë‹¤.



** cc sorce
[Build a multi OS Python app in the cloud: PyInstaller on GitHub Actions - Data-Dive](https://data-dive.com/multi-os-deployment-in-cloud-using-pyinstaller-and-github-actions/)
[GitHub í˜¸ìŠ¤íŒ… ì‹¤í–‰ê¸° ì •ë³´ - GitHub Docs](https://docs.github.com/ko/actions/using-github-hosted-runners/about-github-hosted-runners/about-github-hosted-runners#github-%ED%98%B8%EC%8A%A4%ED%8C%85-%EC%8B%A4%ED%96%89%EA%B8%B0%EC%9A%A9-%ED%81%B4%EB%9D%BC%EC%9A%B0%EB%93%9C-%ED%98%B8%EC%8A%A4%ED%8A%B8)
